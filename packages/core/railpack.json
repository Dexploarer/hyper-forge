{
  "$schema": "https://railpack.com/schema.json",
  "packages": {
    "bun": "latest",
    "node": "22.12.0"
  },
  "caches": {
    "node_modules": {
      "key": "node_modules",
      "paths": ["node_modules"]
    }
  },
  "build": {
    "inputs": [
      {
        "step": "packages",
        "comment": "Install Bun and Node.js runtime"
      },
      {
        "step": "copy",
        "paths": [
          "package.json",
          "bun.lock"
        ],
        "comment": "Copy dependency files first"
      },
      {
        "step": "install",
        "cmd": "bun install --frozen-lockfile",
        "comment": "Install dependencies using Bun"
      },
      {
        "step": "copy",
        "paths": ["**"],
        "comment": "Copy all source files"
      }
    ]
  },
  "deploy": {
    "inputs": [
      {
        "step": "mise",
        "comment": "Ensures bun and node are available at runtime"
      }
    ],
    "cmd": "cd packages/core && bun run start:workers"
  }
}
