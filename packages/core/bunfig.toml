# Bun Configuration for Asset-Forge
# November 2025 Best Practices

[test]
# Root directory for test discovery
root = "."

# DOM environment for React testing
environment = "happydom"

# Patterns to match test files (Bun tests ONLY - NOT Playwright)
# Only matches .test.ts and .test.tsx files
# This excludes .spec.ts/.spec.tsx which are used by Playwright
testMatch = [
  "**/__tests__/integration/**/*.test.ts",
  "**/__tests__/integration/**/*.test.tsx",
  "**/__tests__/unit/**/*.test.ts",
  "**/__tests__/unit/**/*.test.tsx",
  "**/__tests__/helpers/**/*.test.ts"
]

# Exclude E2E tests (Playwright), node_modules, and other non-test directories
testIgnore = [
  "**/__tests__/e2e/**",      # Playwright E2E tests - EXCLUDE ALL
  "**/*.spec.ts",              # Playwright spec files
  "**/*.spec.tsx",             # Playwright spec files
  "**/node_modules/**",
  "**/dist/**",
  "**/.git/**",
  "**/coverage/**",
  "**/build/**"
]

# Test execution
# Run tests in parallel for faster execution
concurrent = true

# Code coverage configuration
coverage = true

# Coverage thresholds - fail if below 80%
coverageThreshold = { lines = 80, functions = 80, statements = 80, branches = 75 }

# Skip test files in coverage reports
coverageSkipTestFiles = true

# Coverage reporters - generate multiple formats
coverageReporter = ["text", "lcov"]

# Coverage output directory
coverageDir = "coverage"

# Exclude patterns from coverage
coveragePathIgnorePatterns = [
  "**/node_modules/**",
  "**/__tests__/**",
  "**/dist/**",
  "**/*.config.*",
  "**/*.test.*",
  "**/*.spec.*",
  "**/scripts/**",
  "**/dev-book/**"
]

# Test timeout (2 minutes default)
timeout = 120000

# Preload scripts (if needed for database setup, etc.)
preload = ["./__tests__/setup-dom.ts"]
